<!DOCTYPE html>
<html>
<head lang="en">

    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <title></title>

    <style type="text/css">

        html{height:100%}

        body{height:100%;margin:0px; padding:0px}

        #cywmap{height:500px;width:100%;}

    </style>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=1.4"> </script>
    <script>
        var arrays1 = new Array();
        var arrays2 = new Array();
        var arrays3 = new Array();
        var arrays4 = new Array();
        var arrays5 = new Array();
        var arrays6 = new Array();
        var num_pointdian;
        var num_pointqi;
        var num_polydian;
        var num_polyqi;
        var dianorqi;
        var markers1 = new Array();
        var markers2 = new Array();
        var polys1 = new Array();
        var polys2 = new Array();
        var opts = {
            width : 180,     // 信息窗口宽度
            height: 60,     // 信息窗口高度
            // title : "信息窗口" , // 信息窗口标题
            enableMessage:false//设置允许信息窗发送短息
        };
        // var s = new Array();
        function makepointdian()
        {
            var oXL = new ActiveXObject("Excel.application");
            var oWB = oXL.Workbooks.open("https://cywzzk.github.io/powerpoint.xls");
            oWB.worksheets(1).select();
            var oSheet = oWB.ActiveSheet;
            try {
                for (var i = 1; i < 50; i++) {
                    if (oSheet.Cells(i, 2).value == "null" || oSheet.Cells(i, 3).value == "null")
                        break;
                    var a = oSheet.Cells(i, 2).value.toString() == "undefined" ? "" : oSheet.Cells(i, 2).value;
                    arrays1[i] = oSheet.Cells(i, 1).value;
                    arrays2[i] = oSheet.Cells(i, 2).value;
                    arrays3[i] = oSheet.Cells(i, 3).value;
                    arrays4[i] = oSheet.Cells(i, 4).value;
                    num_pointdian = i;
                }
            }
            catch(e){
                //    alert("for error")
            }
            oXL.Quit();
            CollectGarbage();
        }
        function makepolydian()
        {
            var oXL = new ActiveXObject("Excel.application");
            var oWB = oXL.Workbooks.open("https://cywzzk.github.io/powerpoly.xls");
            oWB.worksheets(1).select();
            var oSheet = oWB.ActiveSheet;
            try {
                for (var i = 1; i < 50; i++) {
                    if (oSheet.Cells(i, 2).value == "null" || oSheet.Cells(i, 3).value == "null")
                        break;
                    var a = oSheet.Cells(i, 2).value.toString() == "undefined" ? "" : oSheet.Cells(i, 2).value;
                    arrays1[i] = oSheet.Cells(i, 1).value;
                    arrays2[i] = oSheet.Cells(i, 2).value;
                    arrays3[i] = oSheet.Cells(i, 3).value;
                    arrays4[i] = oSheet.Cells(i, 4).value;
                    arrays5[i] = oSheet.Cells(i, 5).value;
                    arrays6[i] = oSheet.Cells(i, 6).value;
                    num_polydian = i;
                }
            }
            catch(e){
                //    alert("for error")
            }
            oXL.Quit();
            CollectGarbage();
        }
        function makepointqi()
        {
            var oXL = new ActiveXObject("Excel.application");
            var oWB = oXL.Workbooks.open("https://cywzzk.github.io/oilpoint.xls");
            oWB.worksheets(1).select();
            var oSheet = oWB.ActiveSheet;
            try {
                for (var i = 1; i < 50; i++) {
                    if (oSheet.Cells(i, 2).value == "null" || oSheet.Cells(i, 3).value == "null")
                        break;
                    var a = oSheet.Cells(i, 2).value.toString() == "undefined" ? "" : oSheet.Cells(i, 2).value;
                    arrays1[i] = oSheet.Cells(i, 1).value;
                    arrays2[i] = oSheet.Cells(i, 2).value;
                    arrays3[i] = oSheet.Cells(i, 3).value;
                    arrays4[i] = oSheet.Cells(i, 4).value;
                    num_pointqi = i;
                }
            }
            catch(e){
                //    alert("for error")
            }
            oXL.Quit();
            CollectGarbage();
        }
        function makepolyqi()
        {
            var oXL = new ActiveXObject("Excel.application");
            var oWB = oXL.Workbooks.open("https://cywzzk.github.io/oilpoly.xls");
            oWB.worksheets(1).select();
            var oSheet = oWB.ActiveSheet;
            try {
                for (var i = 1; i < 50; i++) {
                    if (oSheet.Cells(i, 2).value == "null" || oSheet.Cells(i, 3).value == "null")
                        break;
                    var a = oSheet.Cells(i, 2).value.toString() == "undefined" ? "" : oSheet.Cells(i, 2).value;
                    arrays1[i] = oSheet.Cells(i, 1).value;
                    arrays2[i] = oSheet.Cells(i, 2).value;
                    arrays3[i] = oSheet.Cells(i, 3).value;
                    arrays4[i] = oSheet.Cells(i, 4).value;
                    arrays5[i] = oSheet.Cells(i, 5).value;
                    arrays6[i] = oSheet.Cells(i, 6).value;
                    num_polyqi = i;
                }
            }
            catch(e){
                //    alert("for error")
            }
            oXL.Quit();
            CollectGarbage();
        }
        function openInfo(content,e){

            var p = e.target;
            var point = new BMap.Point(p.getPosition().lng, p.getPosition().lat);
            var infoWindow = new BMap.InfoWindow(content,opts);  // 创建信息窗口对象
            map.openInfoWindow(infoWindow,point); //开启信息窗口
        }
        function openInfo1(content,e){
            //var point =  map.getBounds().getCenter();
            var p = e.target;
            var point = p.getBounds().getCenter();
            var infoWindow = new BMap.InfoWindow(content,opts);  // 创建信息窗口对象
            map.openInfoWindow(infoWindow,point); //开启信息窗口
        }
    </script>
</head>
<body>

<div id = "cywmap"></div>
<div id="r-result">
    <input type="button" onclick="showdian()" value="电气" />
    <input type="button" onclick="showqi()" value="油气" />
</div>

<script type="text/javascript">

    var map = new BMap.Map("cywmap");          // 创建地图实例

    var point = new BMap.Point(121.81, 31.496);  // 创建点坐标

    map.centerAndZoom(point, 15);                 // 初始化地图，设置中心点坐标和地图级别
    map.enableScrollWheelZoom();
    //创建小狐狸
    makepointdian();
    var myIcon = new BMap.Icon("https://cywzzk.github.io/power.gif", new BMap.Size(20,21));
    for ( var i = 1; i <= num_pointdian; i ++) {
        markers1[i] = new BMap.Marker(new BMap.Point(arrays1[i], arrays2[i]),{icon:myIcon});  // 创建标注
        map.addOverlay(markers1[i]);              // 将标注添加到地图中
        //创建信息窗口
        var content = "地点:"+arrays3[i] +"<br> 运行碳排放:"+arrays4[i];
        markers1[i].addEventListener("click",openInfo.bind(null,content));
    }
    makepolydian();

    for ( var i = 1; i <= num_polydian; i ++) {
        polys1[i] = new BMap.Polyline([
            new BMap.Point(arrays1[i], arrays2[i]),
            new BMap.Point(arrays3[i], arrays4[i])
        ], {strokeColor:"blue", strokeWeight:6, strokeOpacity:0.5});   //创建折线
        map.addOverlay(polys1[i]);              // 将标注添加到地图中
        //创建信息窗口
        var content = "建设碳排放:"+arrays5[i] +"<br> 运行碳排放:"+arrays6[i];
        polys1[i].addEventListener("click",openInfo1.bind(null,content));
    }
    makepointqi();
        myIcon = new BMap.Icon("https://cywzzk.github.io/oil.gif", new BMap.Size(20,25));
    for ( var i = 1; i <= num_pointqi; i ++) {
        markers2[i] = new BMap.Marker(new BMap.Point(arrays1[i], arrays2[i]),{icon:myIcon});  // 创建标注
        map.addOverlay(markers2[i]);              // 将标注添加到地图中
        //创建信息窗口
        var content = "地点:"+arrays3[i] +"<br> 运行碳排放:"+arrays4[i];
        markers2[i].addEventListener("click",openInfo.bind(null,content));
    }
    makepolyqi();
    for ( var i = 1; i <= num_polyqi; i ++) {
        polys2[i] = new BMap.Polyline([
            new BMap.Point(arrays1[i], arrays2[i]),
            new BMap.Point(arrays3[i], arrays4[i])
        ], {strokeColor:"red", strokeWeight:6, strokeOpacity:0.5});   //创建折线
        map.addOverlay(polys2[i]);              // 将标注添加到地图中
        //创建信息窗口
        var content = "建设碳排放:"+arrays5[i] +"<br> 运行碳排放:"+arrays6[i];
        polys2[i].addEventListener("click",openInfo1.bind(null,content));
    }
    dinaorqi = 1;
   // map.setViewport(markers1);
   for (var i = 1; i<= num_pointqi; i++)
        markers2[i].hide();
    for ( var  i = 1; i <= num_polyqi; i ++ )
        polys2[i].hide();
    function showqi()
    {
        // if ( dianorqi == 1){
       // map.setViewport(markers2);
        for (var i = 1; i<= num_pointdian; i++)
            markers1[i].hide();
        for ( var  i = 1; i <= num_polydian; i ++ )
            polys1[i].hide();
        for (var i = 1; i<= num_pointqi; i++)
            markers2[i].show();
        for ( var  i = 1; i <= num_polyqi; i ++ )
            polys2[i].show();
        dianorqi = 2;
        // }
    }
    function showdian()
    {
        //   if (dianorqi == 2) {
      //  map.setViewport(markers1);
        for (var i = 1; i <= num_pointdian; i++)
            markers1[i].show();
        for (var i = 1; i <= num_polydian; i++)
            polys1[i].show();
        for (var i = 1; i <= num_pointqi; i++)
            markers2[i].hide();
        for (var i = 1; i <= num_polyqi; i++)
            polys2[i].hide();
        dianorqi = 1;
        //  }
    }
</script>


</body>
</html>